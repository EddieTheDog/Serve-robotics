<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial, sans-serif; background: #fff; padding: 30px; }
  .guest { border: 1px solid #ccc; padding: 16px; margin-bottom: 20px; }
  button { margin: 6px; padding: 10px; font-size: 16px; }
  .guest h3 { margin: 4px 0; }
</style>
</head>
<body>

<h1>Admin Dashboard</h1>
<div id="queue"></div>

<script>
async function loadQueue() {
  const res = await fetch("/api/queue");
  const guests = await res.json();
  const q = document.getElementById("queue");
  q.innerHTML = "";

  guests.forEach(g => {
    const div = document.createElement("div");
    div.className = "guest";

    div.innerHTML = `
      <h3>${g.first_name} ${g.last_name}</h3>
      <button onclick="setStatus('${g.id}','accepted')">Accept</button>
      <button onclick="setStatus('${g.id}','declined')">Decline</button>
      <button onclick="setStatus('${g.id}','help')">Help</button>
      <button onclick="nextGuest('${g.id}')">Next Guest</button>
    `;

    q.appendChild(div);
  });
}

async function setStatus(id,status) {
  await fetch("/api/update", {
    method:"POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ guestId:id, status })
  });
  loadQueue();
}

async function nextGuest(id) {
  await fetch("/api/next", {
    method:"POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ guestId:id })
  });
  loadQueue();
}

// Initial load and auto-refresh every 3 seconds
loadQueue();
setInterval(loadQueue,3000);
</script>

</body>
</html>

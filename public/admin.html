<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Admin Dashboard</h1>
<div id="queue"></div>

<script src="qr.js"></script>
<script>
async function load() {
  const res = await fetch('/api/queue');
  const guests = await res.json();
  queue.innerHTML = '';

  guests.forEach(g => {
    const d = document.createElement('div');
    d.innerHTML = `
      <h3>${g.first_name} ${g.last_name}</h3>
      <div id="qr-${g.id}"></div>
      <button onclick="set('${g.id}','accepted')">Accept</button>
      <button onclick="set('${g.id}','declined')">Decline</button>
    `;
    queue.appendChild(d);
    QRCode(document.getElementById(`qr-${g.id}`), g.id);
  });
}

async function set(id, status) {
  await fetch('/api/update', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ guestId:id, status })
  });
  load();
}

load();
setInterval(load, 3000);
</script>
</body>
</html>
